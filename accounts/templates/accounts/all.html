{% extends 'accounts/search.html' %}


{% block content %}


<!-- navbar -->
<nav>
    <div class="logo">
        {% csrf_token %}
        <a href="/home">  
        <img src="/static/pip.png" alt="Logo">
        </a>
  </div>
  
  <img src="/static/pppp.png" class="user-pic" onclick="toggleMenu()">
  
  
  <div class="submenu-wrap" id="subMenu">
      <div class="submenu">
          <a href="#" class="submenu-link">
              <img src="/static/profile.png"  alt="Profile">
              <p>Edit Profile</p>
              <!-- <span>></span> -->
          </a>
  
          <a href="#" class="submenu-link">
              <img src="/static/setting.png" alt="Settings">
              <p>Settings</p>
              <!-- <span>></span> -->
          </a>
  
          <a href="{% url 'logout' %}" class="submenu-link">
              <img src="/static/logout.png" alt="Logout">
              <p>Logout</p>
              <!-- <span>></span> -->
          </a>
      </div>
  </div>
  
  </nav>


  <div class="box">
<div class="cointainer my-3">
    <h2>Search Results:</h2>
    

<br>
        <div class="table table-bordered">
            <table>
                    <thead-light>
                    <tr>
                        <th scope="col">S.N</th>
                        <th scope="col">Name</th>
                        <th scope="col">Phone Number</th>
                        <th scope="col">Address</th>
                        <th scope="col">Email</th>
                        <th scope="col">Social Media</th>
                        <th scope="col">Action</th> <!-- New column for edit and delete buttons -->
                        

                    </tr>
                </thead>
                <tbody>

                    {% for person in per %}
                    <tr>
                        <!-- <td>{{ person.first_name}} {{ person.last_name }}</td> -->
                        
                        <td>
                            {{ forloop.counter }}
                        </td>
                        
                        <td>
                            {% if person.first_name and person.last_name %}
                                {{ person.first_name }} {{ person.last_name }}
                            {% else %}
                               Not Available
                            {% endif %}
                        </td>

                        <td>
                            {% if person.phone.Number and person.phone.Number_type %}
                                {{ person.phone.Number }} ({{ person.phone.Number_type }})
                            {% else %}
                               Not Available
                            {% endif %}
                        </td>
                        <td>
                            {% if person.address and person.address.Address_type %}
                                {{ person.address }} ({{ person.address.Address_type}})
                            {% else %}
                               Not Available
                            {% endif %}
                        </td>
                        <td>
                            {% if person.email.email and person.email.email_type %}
                                {{ person.email.email }} ({{ person.email.email_type }})
                            {% else %}
                               Not Available
                            {% endif %}
                        </td>
                        
                        <td>
                            {% if person.media.User_Name and person.media.Linked_App %}
                                @{{ person.media.User_Name }} ({{ person.media.Linked_App}})
                            {% else %}
                               Not Available
                            {% endif %}
                        </td>
                        
                        <td>
                            <a href="{%url 'edit' person.id %}" class="action-btn1">Edit</a>
                            <a href="{%url 'delete' person.id%}" class="action-btn2">Delete</a></td>
                        
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7" >No records found.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
        </div>
    </div>
    
</div>

<script>
    let subMenu = document.getElementById("subMenu");
    let userPic = document.querySelector(".user-pic");

    function toggleMenu() {
        subMenu.classList.toggle("open-menu");
    }

    // Function to hide submenu when clicking outside
    function handleClickOutside(event) {
        if (!subMenu.contains(event.target) && !userPic.contains(event.target)) {
            subMenu.classList.remove("open-menu");
        }
    }

    // Event listener to handle clicks on the body
    document.body.addEventListener("click", handleClickOutside);
</script>

{% endblock %}