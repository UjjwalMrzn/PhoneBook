<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/css/all.css">

</head>
<body>
    

    

<!-- /* home remake 2 */ -->
<nav class="navbar-container">
    <div class="logo">
        {% csrf_token %}
        <a href="/home">  
            <img src="/static/pip.png" alt="Logo">
        </a>
    </div>

    
  <div class="search-container">
    <form action="/search" method="get" class="search-bar">
        <input type="text" placeholder="Search" name="query" id="search" required>
        <button type="submit"><img src="/static/search.png"></button>
    </form>
</div>
    
    
    <div class="logout-container"> 
        <span class="hello-msg">Hello, {{request.user}} |</span>
    </div>

    <div class="user-container" onclick="toggleMenu()">
        <img src="/static/pppp.png" class="user-pic" alt="User Picture">
        <img src="/static/dropdown.png" class="dropdown-arrow" alt="Dropdown Arrow">
    </div>
    
    <div class="submenu-wrap" id="subMenu">
        <div class="submenu">
            <a href="#" class="submenu-link">
                <img src="/static/profile.png" alt="Profile">
                <p>Edit Profile</p>
            </a>
            <a href="/about" class="submenu-link">
                <img src="/static/abt.png" alt="About Us">
                <p>About Us</p>
            </a>
            <a href="/contact" class="submenu-link">
                <img src="/static/cnt.png" alt="Contact">
                <p>Contact</p>
            </a>
            <a href="/logout" class="submenu-link">
                <img src="/static/logout.png" alt="Logout">
                <p>Logout</p>
            </a>
        </div>
    </div>
</nav>

  <div class="box">
<div class="cointainer my-3">
    

<br>
        <div class="table table-bordered">
            <table>
                    <thead-light>
                    <tr>
                        <th scope="col">S.N</th>
                        <th scope="col">Name</th>
                        <th scope="col">Phone Number</th>
                        <th scope="col">Address</th>
                        <th scope="col">Email</th>
                        <th scope="col">Social Media</th>
                        {% if request.user.is_staff %}
                        <th scope="col">Action</th> <!-- New column for edit and delete buttons -->
                        {% endif %}


                    </tr>
                </thead>
                <tbody>

                    {% for person in per %}
                    <tr>
                        <!-- <td>{{ person.first_name}} {{ person.last_name }}</td> -->
                        
                        <td>
                            {{ forloop.counter }}
                        </td>
                        
                        <td>
                            {% if person.first_name and person.last_name %}
                                {{ person.first_name }} {{ person.last_name }}
                            {% else %}
                               Not Available
                            {% endif %}
                        </td>

                        <td>
                            {% if person.phone.Number and person.phone.Number_type %}
                                {{ person.phone.Number }} ({{ person.phone.Number_type }})
                            {% else %}
                               Not Available
                            {% endif %}
                        </td>
                        <td>
                            {% if person.address and person.address.Address_type %}
                                {{ person.address }} ({{ person.address.Address_type}})
                            {% else %}
                               Not Available
                            {% endif %}
                        </td>
                        <td>
                            {% if person.email.email and person.email.email_type %}
                                {{ person.email.email }} ({{ person.email.email_type }})
                            {% else %}
                               Not Available
                            {% endif %}
                        </td>
                        
                        <td>
                            {% if person.media.User_Name and person.media.Linked_App %}
                                @{{ person.media.User_Name }} ({{ person.media.Linked_App}})
                            {% else %}
                               Not Available
                            {% endif %}
                        </td>

                        {% if request.user.is_staff %}
                        <td>
                            <a href="{%url 'edit' person.id %}" class="action-btn1">Edit</a>
                            <a href="{%url 'delete' person.id%}" class="action-btn2">Delete</a></td>
                            {% endif %}

                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7" >No records found.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <div class="table-controls">
            <button id="prevButton">Previous</button>
            <button id="nextButton">Next</button>
            
        </div>
        </div>
    </div>
    
</div>
<script>
    // Retrieve DOM elements
    let prevButton = document.getElementById("prevButton");
    let nextButton = document.getElementById("nextButton");
    let userPic = document.querySelector(".user-pic");

    let subMenu = document.getElementById("subMenu");
let userContainer = document.querySelector(".user-container");

function toggleMenu(event) {
    event.stopPropagation(); // Prevent the click event from bubbling up to the body
    subMenu.classList.toggle("open-menu");
}

// Function to hide submenu when clicking outside
function handleClickOutside(event) {
    if (!subMenu.contains(event.target) && !userContainer.contains(event.target)) {
        subMenu.classList.remove("open-menu");
    }
}

// Event listener to handle clicks on the body
document.body.addEventListener("click", handleClickOutside);

// Event listener to handle clicks on the user container
userContainer.addEventListener("click", toggleMenu);
    // Function to show the specified page of rows
    function showPage(pageNumber) {
        let rows = document.querySelectorAll(".table tbody tr");
        let startIndex = (pageNumber - 1) * rowsPerPage;
        let endIndex = Math.min(startIndex + rowsPerPage, rows.length);

        rows.forEach((row, index) => {
            if (index >= startIndex && index < endIndex) {
                row.style.display = "table-row";
            } else {
                row.style.display = "none";
            }
        });

        // Enable or disable previous button based on current page
        prevButton.disabled = currentPage === 1;

        // Enable or disable next button based on current page
        nextButton.disabled = endIndex >= rows.length;
    }

    // Function to handle next page navigation
    function nextPage() {
        currentPage++;
        showPage(currentPage);
    }

    // Function to handle previous page navigation
    function prevPage() {
        if (currentPage > 1) {
            currentPage--;
            showPage(currentPage);
        }
    }

    // Event listeners
    document.body.addEventListener("click", handleClickOutside);
    userPic.addEventListener("click", toggleMenu);
    subMenu.addEventListener("click", function(event){ event.stopPropagation(); }); // Prevent submenu click from closing
    nextButton.addEventListener("click", nextPage);
    prevButton.addEventListener("click", prevPage);

    // Initial display
    showPage(currentPage);



</script>

</body>
</html>